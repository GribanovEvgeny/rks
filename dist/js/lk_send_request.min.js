"use strict";$(document).ready(function(){var e,t,n=$("body"),l=!1;function d(){document.querySelectorAll(".__select").forEach(function(n){var r=n.querySelector(".__select__title"),e=n.querySelectorAll(".__select__label");r.addEventListener("click",function(){"active"===n.getAttribute("data-state")?n.setAttribute("data-state",""):n.setAttribute("data-state","active")});for(var t=0;t<e.length;t++)e[t].addEventListener("click",function(e){r.textContent=e.target.textContent,r.value=e.target.textContent,n.setAttribute("data-state","");var t=this.parentNode.parentNode.parentNode.parentNode.parentNode;t.querySelector(".address__concated")&&o(t)});document.querySelector("body").addEventListener("click",function(e){var t=e.target.classList;"__select__title"!==t[0]&&"__select__content"!==t[0]&&"__select__input"!==t[0]&&n.setAttribute("data-state","")})})}function o(e){var o=e.querySelector(".address__concated"),i=e.querySelector(".address__locality"),s=e.querySelector(".address__district"),u=e.querySelector(".address__microdistrict"),d=e.querySelector(".address__street"),_=e.querySelector(".address__housing"),p=e.querySelector(".address__house");setTimeout(function(){var e="".concat(i.value?"г. "+i.value:""),t="".concat(s.value?", "+s.value+" район":""),n="".concat(u.value?", микрорайон "+u.value:""),r="".concat(d.value?", ул. "+d.value:""),c="".concat(_.value?", корпус "+_.value:""),a="".concat(p.value?", дом "+p.value:""),l="".concat(e+t+n+r+c+a+".");","===l[0]&&(l=l.slice(1)),o.value=l},100)}function _(e){e.querySelector(".address__concated");var t=e.querySelector(".address__locality"),n=e.querySelector(".address__district"),r=e.querySelector(".address__microdistrict"),c=e.querySelector(".address__street"),a=e.querySelector(".address__housing"),l=e.querySelector(".address__house");t&&t.addEventListener("change",function(){return o(e)}),n&&n.addEventListener("change",function(){return o(e)}),r&&r.addEventListener("change",function(){return o(e)}),c&&c.addEventListener("change",function(){return o(e)}),a&&a.addEventListener("change",function(){return o(e)}),l&&l.addEventListener("change",function(){return o(e)})}document.querySelector(".requests_form.simple")&&(l=!0),document.querySelector(".slider")&&$(".slider").slick({nextArrow:'<button type="button" class="slick-arrow slick-next btn dark_btn">Далее</button>',prevArrow:'<button type="button" class="slick-arrow slick-prev btn">Назад</button>',dots:!0,infinite:!1,draggable:!1,adaptiveHeight:!0}),$(".radio").parent().click(function(){var e=$(this).children(".radio");e.is(":disabled")||e.prop("checked",!0)}),document.querySelector(".checkbox")&&(e=$(".checkbox"),t=e.parent(),e.click(function(){var e=$(this),t=e.is(":checked");e.is(":disabled")||e.prop("checked",!t)}),t.click(function(){var e=$(this).children(),t=e.is(":checked");e.is(":disabled")||e.prop("checked",!t)})),document.querySelector(".__select")&&d(document);var r,c,a,i,s,u,p,v=document.querySelectorAll(".address__concated");function m(e,t){var n=document.querySelector(".slick-list"),r=Number.parseInt(n.style.height);return n.style.height="increase"===e?r+t+"px":r-t+"px"}v&&v.forEach(function(e){return _(e.parentNode.parentNode.parentNode)}),document.querySelector('input[name="queue_launch"]')&&(r=$('input[name="queue_launch"]'),c=r.is(":disabled"),a=r.parent(),c||a.click(function(){var e=$(".queue_launch_"+$(this).children().val());$(".queue_launch").not(e).hide(0),e.fadeIn(300)})),document.querySelector(".instructions__btn")&&(i=$(".instructions__btn"),s=$(".modal_instructions"),u=$(".modal_instructions__content"),p=$(".modal_instructions .close"),i.click(function(e){e.preventDefault(),n.css("overflow","hidden"),u.css("overflow-y","auto"),u.css("overflow-x","hidden"),s.removeClass("hidden")}),p.click(function(e){e.preventDefault(),n.css("overflow","auto"),s.addClass("hidden")})),document.querySelector(".queue_launch_yes")&&function(){var e,a=-1;function r(){var e,t,n=document.querySelector(".queue_block").cloneNode(!0);(e=n).querySelector(".form__subheader").innerText="Очередь №".concat(a),e.querySelectorAll("input").forEach(function(e){var t;e.name&&(t=e.name,t+="_".concat(a),e.name=t)}),t=n,document.querySelector(".step_5 .queue_slider").append(t),d(n.querySelector(".__select")),x(n),w(n),N(n),_(n)}(e=document.querySelectorAll(".queue_launch_yes .field__table .table__body .table__row")).length&&e.forEach(function(e){return a+=1}),a<1||m("increase",113+41*a);var l,t,n,o,i,c=$(".queue_launch_yes tbody");function s(){var e=document.querySelector(".queue_launch_yes table"),t=document.querySelector(".queue_slider");e.querySelector("tbody").querySelectorAll(".table__row").forEach(function(e,t){0!==t&&e.remove()}),a=0,t.querySelectorAll(".queue_block").forEach(function(e,t){0!==t&&e.remove()})}function u(){var e,t,n,r;function c(){l.checked=!0,o.removeAttribute("style"),i.removeAttribute("style"),o.classList.remove("hidden"),i.classList.add("hidden"),e.remove()}a<1||(document.body.insertAdjacentHTML("beforeend",'\n                            <section class="modal modal_popup_confirm">\n                              <div class="modal__content modal_popup_confirm__content">\n                                <div class="close"></div>\n                                <div class="modal__text">\n                                  Будут удалены все данные по очередям. Удалить?\n                                </div>\n                                <div class="form__field">\n                                  <button class="form__submit btn btn_agree">Да</button>\n                                  <button class="form__submit btn dark_btn btn_abort">Нет</button>\n                                </div>\n                              </div>\n                            </section>\n                           '),e=document.querySelector(".modal_popup_confirm"),t=e.querySelector(".close"),n=e.querySelector(".btn_abort"),r=e.querySelector(".btn_agree"),t.addEventListener("click",c),n.addEventListener("click",c),r.addEventListener("click",function(){o.removeAttribute("style"),i.removeAttribute("style"),o.classList.add("hidden"),i.classList.remove("hidden"),e.remove(),s()}),m("decrease",100),m("increase",50))}$(".queue_btn").click(function(e){e.preventDefault();var t='\n                      <tr class="table__row">\n                        <td class="table__cell">Очередь №'.concat(++a,'</td>\n                        <td class="table__cell">\n                          <input type="text" class="field__input datepicker_input" name=').concat("TechCondObj_QueueName_"+a,' placeholder="Введите данные" />\n                        </td>\n                      </tr>\n                     ');c.append(t),r(),m("increase",39);var n=c.children().last().find(".datepicker_input");n.datepicker($.datepicker.regional.ru),n.mask("99.99.9999",{autoclear:!1})}),$(".queue_btn_remove").click(function(e){e.preventDefault(),a<1||(--a,c.children().last().remove(),$(".step_5 .queue_slider").children().last().remove(),m("decrease",39))}),n=document.querySelector(".step_2"),o=n.querySelector(".queue_launch_yes"),i=n.querySelector(".queue_launch_no"),n.querySelectorAll('input[name="queue_launch"]').forEach(function(e){return"yes"===e.value?l=e:"no"===e.value?t=e:void 0}),l.disabled||t.disabled||(t.parentNode.addEventListener("click",u),l.parentNode.addEventListener("click",function(){return m("decrease",50),void m("increase",100)}))}();var h=$(".other_water_sources tbody"),f=2;$(".add_source_btn").click(function(e){e.preventDefault(),h.append('\n                    <tr class="table__row">\n                      <td class="table__cell">\n                        <input type="text" class="field__input" placeholder="Введите данные" />\n                      </td>\n                      <td class="table__cell">\n                        <input type="text" class="field__input" placeholder="Введите данные" />\n                      </td>\n                      <td class="table__cell">\n                        <input type="text" class="field__input" placeholder="Введите данные" />\n                      </td>\n                    </tr>\n                   '),f++,m("increase",39)}),$(".add_source_btn_remove").click(function(e){e.preventDefault(),2<f&&(h.children().last().remove(),f--,m("decrease",39))});var y,b,q,S,k,g,L=$(".land_coverage_characteristics tbody"),E=2;function x(e){e.querySelector(".datepicker_input")&&$(".datepicker_input").mask("99.99.9999",{autoclear:!1}),e.querySelector(".snils_input")&&$(".snils_input").mask("999-999-999 99",{autoclear:!1}),e.querySelector(".passport_input")&&$(".passport_input").mask("99 99 / 999999",{autoclear:!1}),e.querySelector(".passport_serial_input")&&$(".passport_serial_input").mask("99 99",{autoclear:!1}),e.querySelector(".passport_number_input")&&$(".passport_number_input").mask("999999",{autoclear:!1}),e.querySelector(".phone_input")&&$(".phone_input").mask("(999) 999-9999",{autoclear:!1}),e.querySelector(".tin_ul_input")&&$(".tin_ul_input").mask("9999999999",{autoclear:!1}),e.querySelector(".tin_fl_input")&&$(".tin_fl_input").mask("999999999999",{autoclear:!1}),e.querySelector(".tin_e_input")&&$(".tin_e_input").mask("999999999999",{autoclear:!1}),e.querySelector(".integer_input")&&$(".integer_input").on("input",function(){$(this).val($(this).val().replace(/[^0-9]/g,""))}),e.querySelector(".float_input")&&$(".float_input").keypress(function(e){46==e.which&&-1==$(this).val().indexOf(".")||!(e.which<48||57<e.which)||e.preventDefault()})}function w(e){var t=e.querySelector(".connection_to_cold_water"),n=t.parentNode,r=t.checked,c=t.disabled,a=e.querySelector(".cold_water_supply_toggle");r&&a.classList.remove("hidden"),r||a.classList.add("hidden"),c||n.addEventListener("click",function(){var e=l?225:1e3;(r=!r)?(a.classList.remove("hidden"),m("increase",e)):(a.classList.add("hidden"),m("decrease",e))})}$(".add_coverage_btn").click(function(e){e.preventDefault();L.append('\n                    <tr class="table__row">\n                      <td class="table__cell">\n                        <input type="text" class="field__input" placeholder="Введите данные" />\n                      </td>\n                      <td class="table__cell">\n                        <input type="text" class="field__input" placeholder="Введите данные" />\n                      </td>\n                    </tr>\n                   '),E++,m("increase",39)}),$(".add_coverage_btn_remove").click(function(e){e.preventDefault(),E<=1||(L.children().last().remove(),E--,m("decrease",39))}),document.querySelector(".datepicker_input")&&$(".datepicker_input").datepicker($.datepicker.regional.ru),x(document),document.querySelector(".representative")&&(y=document.querySelector(".representative"),b=y.querySelector(".yes"),q=b.checked,S=b.parentNode,k=y.querySelector(".no").parentNode,g=document.querySelector(".representative_add_docs_block"),q&&g.classList.remove("hidden"),q||g.classList.add("hidden"),S.addEventListener("click",function(){return g.classList.remove("hidden")}),k.addEventListener("click",function(){return g.classList.add("hidden")}));var A=document.querySelectorAll(".queue_block");function N(e){var t=e.querySelector(".connection_to_drainage"),n=t.parentNode,r=t.checked,c=t.disabled,a=e.querySelector(".drainage_toggle");r&&a.classList.remove("hidden"),r||a.classList.add("hidden"),c||n.addEventListener("click",function(){var e=l?225:750;(r=!r)?(a.classList.remove("hidden"),m("increase",e)):(a.classList.add("hidden"),m("decrease",e))})}function D(e){return e.siblings(".required").text()}A&&A.forEach(w),A&&A.forEach(N),"10002"==$('input[name="requesttype_id"]').val()&&$('input[name="personbasis"][value="05"]').parent().attr("style","display:none;");var C=$("form");function j(){var e=$(".__select__title.field__input.cascader_input.address__street").val(),t=$('.__select input[name="Town_code"]:checked').val(),n=$(".__select__title.field__input.cascader_input.address__street").next(".__select__content");""!=e&&null!=t?$.ajax({url:"./getStreetsJson/?townCode="+t+"&street_name="+e,success:function(e){var t=JSON.parse(JSON.parse(e));n.html('<input id="street_0" class="__select__input" type="radio" name="Street_code" selected="" checked="" /><label for="street_0" class="__select__label">Выберите улицу</label>'),t.forEach(function(e){return n.html(n.html()+'<input id="street_'+e.id+'" class="__select__input" type="radio" name="Street_code" selected="" checked="" /><label for="street_'+e.id+'" class="__select__label">'+e.name+"</label>")})}}):n.empty()}$("input[type='submit']").click(function(e){switch($(document.activeElement,this).attr("name")){case"ecp_button":e.preventDefault(),e.stopPropagation();var t=[];if(C.find(".required + *").each(function(){var e=$(this);switch(e.prop("tagName")){case"SPAN":0==e.find("input:checked").length&&t.push("Не выбрано ни одно значение поля "+D(e));break;case"INPUT":!e.val()&&e.is(":visible")&&t.push("Не указано значение поля "+D(e));break;case"DIV":e.is(":visible")&&("Выберите тип документа"==e.find(".__select__title").text()||"Полученный адрес"==e.text()||0==e.find(".attachment").length&&e.hasClass("field__control_btns"))&&t.push("Не указано значение поля "+D(e))}}),t.length)return $(".modal.modal_alert.autopopup.hidden .modal__text").text(t[0]),void $(".modal.modal_alert.autopopup.hidden").removeClass("hidden");(C=$(this).closest("form")).append("<input type='hidden' name='ecp' value='true' />"),C.submit();break;case"save_button":$('input[name="redirect"]').val("newrequesttp")}}),$.ajax({url:"./getSimpleJson/",success:function(e){JSON.parse(e)?(document.querySelectorAll("[name='infmaxparam3'],[name='infmaxparam4'],[name='techcondobj_note'],[name='connectloadparamdata_value2'],[name='addconnectloadparamdata_value_05'],[name='connectloadparamdata_value2_2'],[name='addconnectloadparamdata_value_06']").forEach(function(e){return e.parentElement.classList.add("hidden")}),document.querySelectorAll('[name="connectobjkind"]').forEach(function(e){return e.addEventListener("change",function(){})})):document.querySelectorAll('[name="connectobjkind"]').forEach(function(e){return e.addEventListener("change",function(){})})}}),$('.__select input[name="Town_code"]').change(function(e){j()}),$(".__select__title.field__input.cascader_input.address__street").keyup(function(e){j()})});